{% extends "base.html" %}
{% load staticfiles %}
{% load bootstrap3 %}


{% block title %}Gospel Statistics{% endblock %}
{% block references %}
<script>

const WEEKLY_STATISTICS = "{% url 'gospel_statistics:weekly-statistics' %}";

$(document).ready(function() {
  //Week 0-20 selector
  for (var week_num = 0; week_num < 21; week_num++){
    var each=$('<option></option>', {'value': week_num});
    each.text('Week '+week_num);
    if (week_num == {{week}}){
      //console.log(week_num);
      //console.log({{week}});
      each.selected = true;
    };
    $('#gospelWeek').append(each);
  };

  //console.log('first');
  $.getJSON(WEEKLY_STATISTICS,
  (partners) => {
    for(var each=0; each < partners.length; each++)
    {
      //console.log(partners[each]);
    }
  });
});
</script>
{% endblock %}

{% block content %}
<h2>{{ page_title }}</h2>

<!--Team and Week-->
<div>
  <table style="font-size:1.2em">
    <td>
      <b>Team:</b>
      {{team}}
    </td>
    <td>
      <b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Week Of:</b>
      <select id="gospelWeek"/>
    </td>
  </table>
</div>

<!--Total stats-->
{% include "gospel_statistics/gospel_statistics_table.html" %}

<!--Current week stats-->
<form action="" method="post">
{% csrf_token %}
<div>
<table class="table table-bordered-wkly-sum">
  <thead>
    <tr>
      <th scope="col" class="col-md-1">Team Statistics - Week {{week}}</th>
      {% for each in cols %}
      <th scope="col" class="col-md-1">{{each}}</th>
      {% endfor %}
    </tr>
  </thead>

  <tbody>
    {% for each in current %}
    <tr>
      <th>
        <input style="display:none" name="pairs" value={{each.gospel_pair.id}}>
        {% for every in each.gospel_pair.trainees.all %}
          {{every}},
        {% endfor %}
        <div>
          <a href="">
            <button class="btn btn-primary" title="Edit gospel pair">
              <span class="glyphicon glyphicon-pencil"></span>
            </button>
          </a>
          <a>
            <button class="btn btn-primary" title="Delete gospel pair">
              <span class="glyphicon glyphicon-trash"></span>
            </button>
          </a>
        </div>
      </th>
      <td>
        <input type="text" name="inputs" size="4" value={{each.tracts_distributed}}>
      </td>
      <td>
        <input type="text" name="inputs" size="4" value={{each.bibles_distributed}}>
      </td>
      <td>
        <input type="text" name="inputs" size="4" value={{each.contacted_30_sec}}>
      </td>
      <td>
        <input type="text" name="inputs" size="4" value={{each.led_to_pray}}>
      </td>
      <td>
        <input type="text" name="inputs" size="4" value={{each.baptized}}>
      </td>
      <td>
        <input type="text" name="inputs" size="4" value={{each.2nd_appointment}}>
      </td>
      <td>
        <input type="text" name="inputs" size="4" value={{each.regular_appointment}}>
      </td>
      <td>
        <input type="text" name="inputs" size="4" value={{each.minutes_on_the_gospel}}>
      </td>
      <td>
        <input type="text" name="inputs" size="4" value={{each.minutes_in_appointment}}>
      </td>
      <td>
        <input type="text" name="inputs" size="4" value={{each.bible_study}}>
      </td>
      <td>
        <input type="text" name="inputs" size="4" value={{each.small_groups}}>
      </td>
      <td>
        <input type="text" name="inputs" size="4" value={{each.district_meeting_new_student}}>
      </td>
      <td>
        <input type="text" name="inputs" size="4" value={{each.conference}}>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
</div>
<div>
  <p>
    <a href="{% url 'gospel_statistics:new-pair' %}">
      <button class="btn btn-primary" title="Add a new gospel pair">Add new pair</button>
    </a>
  </p>
  <button type="submit" class="btn btn-primary" title="Save current statistics">Save</button>
</div>
</form>
{% endblock %}
